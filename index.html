<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Protected Bulk Generator</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

<style>
body{
  margin:0;
  font-family:sans-serif;
  background:#111;
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
  color:white;
}
.box{
  width:95%;
  max-width:400px;
}
input,button{
  width:100%;
  padding:12px;
  margin:8px 0;
  border-radius:8px;
  border:none;
}
button{
  background:#e11d48;
  color:white;
  font-weight:bold;
}
</style>
</head>
<body>

<div class="box">
<h2>Protected Comic Generator</h2>

<input type="text" id="slug" placeholder="Comic Folder Slug">
<input type="text" id="title" placeholder="Comic Display Title">
<input type="number" id="start" placeholder="Start Chapter">
<input type="number" id="end" placeholder="End Chapter">

<button onclick="generate()">Generate ZIP</button>

<p id="status"></p>
</div>

<script>

function chapterTemplate(slug,title,ch){

return `<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>${title} - Chapter ${ch}</title>

<style>
body, html { margin:0; padding:0; background:#000; overflow-x:hidden; height:100vh; }
#comic { width:100%; max-width:800px; margin:0 auto; }
img { display:block; width:100% !important; height:auto !important; margin:0; padding:0; pointer-events:none; -webkit-touch-callout:none; -webkit-user-drag:none; }
.overlay { position:absolute; top:0; left:0; width:100%; height:100%; background:transparent; pointer-events:auto; }
</style>
</head>

<body>

<script>
function getCookie(name) {
  let matches = document.cookie.match(new RegExp(
    "(?:^|; )" + name.replace(/([.$?*|{}()\\\\[\\\\]\\\\\\\\/+^])/g, '\\\\$1') + "=([^;]*)"
  ));
  return matches ? decodeURIComponent(matches[1]) : "";
}

if (getCookie("site_access") !== "true") {
  document.documentElement.innerHTML = \`
  <head><title>Access Blocked</title></head>
  <body style="margin:0;background:#111;color:white;font-family:Arial;text-align:center;padding:50px;">
    <div style="font-size:24px;background:#900;padding:30px;border-radius:15px;max-width:90%;margin:auto;">
      ⚠️ Direct Access Blocked<br><br>
      Shortener solve karke hi site open hogi.<br><br>
      <a href="https://gplinks.co/BFmfakvr"
      style="color:#fff;background:#f00;padding:15px;border-radius:10px;text-decoration:none;">
      Unlock Site
      </a>
    </div>
  </body>\`;
  throw new Error("Access blocked");
}
<\/script>

<div id="comic"></div>

<script>
document.addEventListener('contextmenu', e => e.preventDefault());
document.addEventListener('dragstart', e => e.preventDefault());

const basePath = "https://cdn.jsdelivr.net/gh/maxton480/Comics@main/comics/${slug}/ch${ch}/";

const container = document.getElementById('comic');

for (let i = 1; i <= 100; i++) {
  const num = i.toString().padStart(3, '0');
  const src = basePath + num + '.webp';

  const div = document.createElement('div');
  div.style.position = 'relative';

  const img = document.createElement('img');
  img.src = src;
  img.loading = "lazy";
  img.onerror = () => div.remove();

  const overlay = document.createElement('div');
  overlay.className = 'overlay';

  div.appendChild(img);
  div.appendChild(overlay);
  container.appendChild(div);
}
<\/script>

</body>
</html>`;
}

async function generate(){

const slug=document.getElementById("slug").value.trim();
const title=document.getElementById("title").value.trim();
const start=parseInt(document.getElementById("start").value);
const end=parseInt(document.getElementById("end").value);

if(!slug||!title||!start||!end){alert("Fill all fields");return;}

const zip=new JSZip();

for(let ch=start;ch<=end;ch++){
zip.file("ch"+ch+".html",chapterTemplate(slug,title,ch));
}

document.getElementById("status").innerText="Creating ZIP...";

zip.generateAsync({type:"blob"}).then(function(content){
const link=document.createElement("a");
link.href=URL.createObjectURL(content);
link.download=slug+"_protected_chapters.zip";
link.click();
document.getElementById("status").innerText="Download Ready ✅";
});

}
</script>

</body>
</html>
